<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sinosoft.platform.core.domain.mapper.TDefUserTraceMapper">
	<resultMap id="BaseResultMap" type="com.sinosoft.platform.core.domain.model.TDefUserTrace">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		<id column="ID" jdbcType="DECIMAL" property="id" />
		<result column="USER_ID" jdbcType="VARCHAR" property="userId" />
		<result column="USER_IP" jdbcType="VARCHAR" property="userIp" />
		<result column="PRIVILEGE_ID" jdbcType="DECIMAL" property="privilegeId" />
		<result column="INSERT_TIME" jdbcType="DATE" property="insertTime" />
		<result column="TRACE_URL" jdbcType="CHAR" property="traceUrl" />
		<result column="TRACE_FUNC" jdbcType="CHAR" property="traceFunc" />
		<result column="TRACE_MSG" jdbcType="CHAR" property="traceMsg" />
	</resultMap>
	<sql id="Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		<where>
			<foreach collection="oredCriteria" item="criteria" separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value" item="listItem"
										open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Update_By_Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		<where>
			<foreach collection="example.oredCriteria" item="criteria"
				separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value" item="listItem"
										open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		ID, USER_ID, USER_IP, PRIVILEGE_ID, INSERT_TIME, TRACE_URL,
		TRACE_FUNC, TRACE_MSG
	</sql>
	<select id="selectByExample" parameterType="com.sinosoft.platform.core.domain.model.TDefUserTraceExample"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		select
		<if test="distinct">
			distinct
		</if>
		<include refid="Base_Column_List" />
		from T_DEF_USER_TRACE
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>
	<select id="selectByPrimaryKey" parameterType="java.math.BigDecimal"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		select
		<include refid="Base_Column_List" />
		from T_DEF_USER_TRACE
		where ID = #{id,jdbcType=DECIMAL}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.math.BigDecimal">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		delete from T_DEF_USER_TRACE
		where ID = #{id,jdbcType=DECIMAL}
	</delete>
	<delete id="deleteByExample" parameterType="com.sinosoft.platform.core.domain.model.TDefUserTraceExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		delete from T_DEF_USER_TRACE
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</delete>
	<insert id="insert" parameterType="com.sinosoft.platform.core.domain.model.TDefUserTrace">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		insert into T_DEF_USER_TRACE (ID, USER_ID, USER_IP,
		PRIVILEGE_ID, INSERT_TIME, TRACE_URL,
		TRACE_FUNC, TRACE_MSG)
		values (SEQ_T_DEF_USER_TRACE.nextval, #{userId,jdbcType=VARCHAR},
		#{userIp,jdbcType=VARCHAR},
		#{privilegeId,jdbcType=DECIMAL}, SYSDATE, #{traceUrl,jdbcType=CHAR},
		#{traceFunc,jdbcType=CHAR}, #{traceMsg,jdbcType=CHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.sinosoft.platform.core.domain.model.TDefUserTrace">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		insert into T_DEF_USER_TRACE
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				ID,
			</if>
			<if test="userId != null">
				USER_ID,
			</if>
			<if test="userIp != null">
				USER_IP,
			</if>
			<if test="privilegeId != null">
				PRIVILEGE_ID,
			</if>
			<if test="insertTime != null">
				INSERT_TIME,
			</if>
			<if test="traceUrl != null">
				TRACE_URL,
			</if>
			<if test="traceFunc != null">
				TRACE_FUNC,
			</if>
			<if test="traceMsg != null">
				TRACE_MSG,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=DECIMAL},
			</if>
			<if test="userId != null">
				#{userId,jdbcType=VARCHAR},
			</if>
			<if test="userIp != null">
				#{userIp,jdbcType=VARCHAR},
			</if>
			<if test="privilegeId != null">
				#{privilegeId,jdbcType=DECIMAL},
			</if>
			<if test="insertTime != null">
				SYSDATE,
			</if>
			<if test="traceUrl != null">
				#{traceUrl,jdbcType=CHAR},
			</if>
			<if test="traceFunc != null">
				#{traceFunc,jdbcType=CHAR},
			</if>
			<if test="traceMsg != null">
				#{traceMsg,jdbcType=CHAR},
			</if>
		</trim>
	</insert>
	<select id="countByExample" parameterType="com.sinosoft.platform.core.domain.model.TDefUserTraceExample"
		resultType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		select count(*) from T_DEF_USER_TRACE
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</select>
	<update id="updateByExampleSelective" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		update T_DEF_USER_TRACE
		<set>
			<if test="record.id != null">
				ID = #{record.id,jdbcType=DECIMAL},
			</if>
			<if test="record.userId != null">
				USER_ID = #{record.userId,jdbcType=VARCHAR},
			</if>
			<if test="record.userIp != null">
				USER_IP = #{record.userIp,jdbcType=VARCHAR},
			</if>
			<if test="record.privilegeId != null">
				PRIVILEGE_ID = #{record.privilegeId,jdbcType=DECIMAL},
			</if>
			<if test="record.insertTime != null">
				INSERT_TIME = #{record.insertTime,jdbcType=DATE},
			</if>
			<if test="record.traceUrl != null">
				TRACE_URL = #{record.traceUrl,jdbcType=CHAR},
			</if>
			<if test="record.traceFunc != null">
				TRACE_FUNC = #{record.traceFunc,jdbcType=CHAR},
			</if>
			<if test="record.traceMsg != null">
				TRACE_MSG = #{record.traceMsg,jdbcType=CHAR},
			</if>
		</set>
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByExample" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		update T_DEF_USER_TRACE
		set ID = #{record.id,jdbcType=DECIMAL},
		USER_ID = #{record.userId,jdbcType=VARCHAR},
		USER_IP = #{record.userIp,jdbcType=VARCHAR},
		PRIVILEGE_ID = #{record.privilegeId,jdbcType=DECIMAL},
		INSERT_TIME = #{record.insertTime,jdbcType=DATE},
		TRACE_URL = #{record.traceUrl,jdbcType=CHAR},
		TRACE_FUNC = #{record.traceFunc,jdbcType=CHAR},
		TRACE_MSG = #{record.traceMsg,jdbcType=CHAR}
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.sinosoft.platform.core.domain.model.TDefUserTrace">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		update T_DEF_USER_TRACE
		<set>
			<if test="userId != null">
				USER_ID = #{userId,jdbcType=VARCHAR},
			</if>
			<if test="userIp != null">
				USER_IP = #{userIp,jdbcType=VARCHAR},
			</if>
			<if test="privilegeId != null">
				PRIVILEGE_ID = #{privilegeId,jdbcType=DECIMAL},
			</if>
			<if test="insertTime != null">
				INSERT_TIME = #{insertTime,jdbcType=DATE},
			</if>
			<if test="traceUrl != null">
				TRACE_URL = #{traceUrl,jdbcType=CHAR},
			</if>
			<if test="traceFunc != null">
				TRACE_FUNC = #{traceFunc,jdbcType=CHAR},
			</if>
			<if test="traceMsg != null">
				TRACE_MSG = #{traceMsg,jdbcType=CHAR},
			</if>
		</set>
		where ID = #{id,jdbcType=DECIMAL}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.sinosoft.platform.core.domain.model.TDefUserTrace">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed May 25 
			13:53:35 CST 2016. -->
		update T_DEF_USER_TRACE
		set USER_ID = #{userId,jdbcType=VARCHAR},
		USER_IP = #{userIp,jdbcType=VARCHAR},
		PRIVILEGE_ID = #{privilegeId,jdbcType=DECIMAL},
		INSERT_TIME = #{insertTime,jdbcType=DATE},
		TRACE_URL = #{traceUrl,jdbcType=CHAR},
		TRACE_FUNC = #{traceFunc,jdbcType=CHAR},
		TRACE_MSG = #{traceMsg,jdbcType=CHAR}
		where ID = #{id,jdbcType=DECIMAL}
	</update>
	<sql id="queryOperateLogInfo">
		SELECT du.usercode usercode,du.username username,to_char(uu.insert_time,'yyyy-mm-dd HH24:mm:ss') inserttime,uu.user_ip userip,uu.trace_msg tracemsg
		FROM t_def_user_trace uu
		LEFT JOIN t_def_user du ON to_char(du.id)=uu.user_id
		LEFT JOIN t_def_user_role_rela rr ON to_char(rr.user_id)=uu.user_id
		where 1=1
		<if test="startDate !=null and startDate !=''">
			and to_date(to_char(uu.insert_time,'yyyy-mm-dd'),'yyyy-mm-dd')>=to_date(#{startDate,jdbcType=VARCHAR},'yyyy-mm-dd')
		</if>
		<if test="endDate !=null and endDate !=''">
			and to_date(to_char(uu.insert_time,'yyyy-mm-dd'),'yyyy-mm-dd')<![CDATA[<=]]>to_date(#{endDate,jdbcType=VARCHAR},'yyyy-mm-dd')
		</if>
		<if test="userCode !=null and userCode !=''">
			and du.usercode like '%' || #{userCode,jdbcType=VARCHAR} || '%' 
		</if>
		<if test="userName !=null and userName !=''">
			and du.username like '%' || #{userName,jdbcType=VARCHAR} || '%' 
		</if>
		<if test="empowerCode !=null and empowerCode !=''">
			and du.empower_code like '%' || #{empowerCode,jdbcType=VARCHAR} || '%'
		</if>
	</sql>
	<select id="queryCount" resultType="java.lang.Integer" parameterType="java.util.Map" >
		select count(*) from (
		  <include refid="queryOperateLogInfo"/>
		  )
	</select>
	<select id="OperateLogInfo" resultType="java.util.Map" parameterType="java.util.Map" >
		<include refid="queryOperateLogInfo"/>
	</select>
	<select id="queryOperateLog" resultType="java.util.Map" parameterType="java.util.Map" >
		select tAlias.* from
		(
	         select nAlias.*, rownum r_rownum from
	         (
		         <include refid="queryOperateLogInfo"/>
		         order by insert_time desc
			 ) nAlias
		) tAlias where r_rownum >=#{queryStartIndex} and #{queryEndIndex} >= r_rownum
	</select>
</mapper>